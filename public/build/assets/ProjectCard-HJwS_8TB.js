import{h as N,k as m,z as ot,T as O,f as w,b as e,e as d,t as u,d as c,n as x,i as p,G as j,a as r,v as R,w as y,F as st,o as h,u as a,m as b,H as lt,q as rt}from"./app-BloNxtzK.js";import{_ as q,a as G,D as at}from"./DangerButton-CmKKXpRm.js";import{S as nt}from"./SaveButton-jhdoi0T8.js";import{_ as f,a as V,b as _}from"./TextInput-PwV-8zbG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const it={class:"text-white font-bold mb-2 max-w-[288px]"},dt={class:"mb-1"},ct={class:"flex"},ut={class:"f w-[224px]"},pt={class:"mb-1"},mt={class:"block"},ft={class:"mb-1"},vt={class:""},gt={class:"mb-1 underline cursor-pointer"},yt={class:"w-[102px]"},wt={class:"flex items-center gap-2 justify-end mb-2"},xt=["id"],jt={class:"flex items-center gap-2 justify-end mb-2"},ht={class:"p-6"},bt={class:"mt-6"},_t={class:"mt-6"},kt={class:"mt-6"},Vt={class:"relative w-3/4"},Ct={class:"absolute right-2 top-[9px]"},Mt={class:"mt-6"},Tt={class:"relative w-3/4"},Ht={class:"absolute right-2 top-[9px]"},Dt={class:"mt-6"},zt={class:"flex gap-2 items-center w-3/4"},St={class:""},Bt={class:"mt-6 flex justify-end"},Lt={class:"p-6"},Nt={class:"mt-6 flex justify-end"},Kt={__name:"ProjectCard",props:{project:{type:Object},client:{type:Object},index:{type:Number}},emits:["delete:project","update:project"],setup(i,{emit:J}){const s=i,P=N(()=>s.project),C=m(!1),U=m(!1),k=m("00:00:00");let $=1,M=0;const Q=m(!1),T=J;ot(()=>{console.log("project",s.project),X()});const W=N(()=>l.extra_time>0?(l.extra_time/60).toFixed(2):0),I=N(()=>A(P.value.total_time)),X=()=>{s.project.time_started&&E(!0),s.project.total_time&&(Q.value=s.project.total_time)},E=(n=!1)=>{if(C.value=!0,n){M=s.project.time_id;const o=new Date(s.project.time_started);K(o);return}k.value="00:00:00";const t=new Date;axios.post(route("project.startTime",s.project.id),{startedAt:t.toUTCString()}).then(o=>{o.data.success&&o.data.id>0&&(M=o.data.id,K(t))}).catch(function(o){})},Y=()=>{C.value=!1,clearInterval($);const n=new Date;axios.post(route("timeTable.stopTime",M),{stoppedAt:n.toUTCString()}).then(t=>{console.log(t),t.data.success&&(console.log(t.data.project.total_time),P.value.total_time=t.data.project.total_time)}).catch(function(t){})},K=n=>{$=setInterval(()=>{const o=new Date().getTime()-n.getTime(),g=Math.round(o/1e3);k.value=A(g)},1e3)},A=n=>{let t=Math.floor(n/3600),o=Math.floor(n%(60*60)/60),g=Math.floor(n%60/1);return t=(t<10?"0":"")+t,o=(o<10?"0":"")+o,g=(g<10?"0":"")+g,t+":"+o+":"+g},H=m(!1),F=O({name:""}),Z=()=>{H.value=!0},tt=()=>{axios.delete(route("project.destroy",s.project.id)).then(n=>{n.data.success&&(T("delete:project",s.index),D())}).catch(function(n){})},D=()=>{H.value=!1},z=m(null),S=m(!1);let l;const et=()=>{l=O({name:s.project.name,hourly_rate:String(s.project.hourly_rate),hourly_rate_two:String(s.project.hourly_rate_two),notes:s.project.notes,extra_time:s.project.extra_time,client_slug:s.client.slug}),S.value=!0,rt(()=>z.value.focus())},v=()=>{l.put(route("project.update",s.project.id),{preserveScroll:!0,onSuccess:()=>{T("update:project"),B()},onError:()=>{z.value.focus(),T("update:project")}})},B=()=>{S.value=!1,l.reset()},L=n=>{console.log(route("project.prioroty",s.project.id)),axios.patch(route("project.prioroty",s.project.id),{prioroty:n}).then(t=>{t.data.success&&(s.project.prioroty=n)}).catch(function(t){})};return(n,t)=>(h(),w(st,null,[e("div",null,[(h(),w("svg",{onClick:d(et,["stop"]),class:"absolute right-8 top-3 w-4 h-4 cursor-pointer fill-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t[15]||(t[15]=[e("path",{d:"M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"},null,-1)]))),(h(),w("svg",{onClick:d(Z,["stop"]),class:"absolute right-3 top-3 w-4 h-4 cursor-pointer fill-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},t[16]||(t[16]=[e("path",{d:"M170.5 51.6L151.5 80h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6H177.1c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6L354.2 80H368h48 8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128H24c-13.3 0-24-10.7-24-24S10.7 80 24 80h8H80 93.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128V432c0 17.7 14.3 32 32 32H336c17.7 0 32-14.3 32-32V128H80zm80 64V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16z"},null,-1)]))),e("h2",it,u(i.project.name),1),e("p",dt,[t[17]||(t[17]=c("Prioroty: ")),e("span",{onClick:t[0]||(t[0]=d(o=>L("high"),["stop"])),class:x(["cursor-pointer",{"text-red-500":s.project.prioroty=="high"}])},"High",2),t[18]||(t[18]=c(" / ")),e("span",{onClick:t[1]||(t[1]=d(o=>L("middle"),["stop"])),class:x(["cursor-pointer",{"text-yellow-500":s.project.prioroty=="middle"}])},"Middle",2),t[19]||(t[19]=c(" / ")),e("span",{onClick:t[2]||(t[2]=d(o=>L("low"),["stop"])),class:x(["cursor-pointer",{"text-green-500":s.project.prioroty=="low"}])},"Low",2)]),e("div",ct,[e("div",ut,[p(e("p",pt,[t[20]||(t[20]=c("Prdiod from: ")),e("span",mt,u(i.project.period_from),1)],512),[[j,i.project.period_from]]),p(e("p",{class:"mb-1"},"Ended At: "+u(i.project.ended_at),513),[[j,i.project.ended_at]]),p(e("p",ft,[t[21]||(t[21]=c("Total time: ")),e("span",vt,u(I.value),1)],512),[[j,I.value]]),p(e("p",gt,"Time Table",512),[[j,i.project.earnings]])]),e("div",yt,[e("div",wt,[r(f,{for:"selected-"+i.project.id,value:"selected",class:"text-white text-sm font-light leading-5",onClick:t[3]||(t[3]=d(()=>{},["stop"]))},null,8,["for"]),p(e("input",{type:"checkbox",id:"selected-"+i.project.id,"onUpdate:modelValue":t[4]||(t[4]=o=>i.project.selected=o),onClick:t[5]||(t[5]=d(()=>{},["stop"]))},null,8,xt),[[R,i.project.selected]])]),e("div",jt,[r(f,{for:"ended",value:"ended",class:"text-white text-sm font-light leading-5",onClick:t[6]||(t[6]=d(()=>{},["stop"]))}),p(e("input",{type:"checkbox",id:"ended","onUpdate:modelValue":t[7]||(t[7]=o=>U.value=o),onClick:t[8]||(t[8]=d(()=>{},["stop"]))},null,512),[[R,U.value]])]),p(e("p",{class:"mb-1 text-right"},u(k.value),513),[[j,k.value]])])]),C.value?(h(),w("svg",{key:0,onClick:d(Y,["stop"]),class:"absolute right-3 bottom-3 w-8 h-8 cursor-pointer fill-red-400 hover:fill-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},t[22]||(t[22]=[e("path",{d:"M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"},null,-1)]))):(h(),w("svg",{key:1,onClick:t[9]||(t[9]=d(o=>E(!1),["stop"])),class:"absolute right-3 bottom-3 w-8 h-8 cursor-pointer fill-green-400 hover:fill-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},t[23]||(t[23]=[e("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"},null,-1)])))]),r(q,{show:S.value,onClose:B},{default:y(()=>[e("div",ht,[t[28]||(t[28]=e("h2",{class:"text-lg font-medium text-gray-900"}," Edit Project ",-1)),e("div",bt,[r(f,{for:"name",value:"name",class:"sr-only"}),r(V,{id:"name",ref:"projectNameInput",modelValue:a(l).name,"onUpdate:modelValue":t[10]||(t[10]=o=>a(l).name=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Project Name",onKeyup:b(v,["enter"])},null,8,["modelValue"]),r(_,{message:a(l).errors.name,class:"mt-2"},null,8,["message"])]),e("div",_t,[r(f,{for:"notes",value:"notes",class:"sr-only"}),p(e("textarea",{id:"notes",ref_key:"editNameInput",ref:z,"onUpdate:modelValue":t[11]||(t[11]=o=>a(l).notes=o),type:"text",class:"mt-1 block w-3/4 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"Project Name",onKeyup:b(v,["enter"])},null,544),[[lt,a(l).notes]]),r(_,{message:a(l).errors.notes,class:"mt-2"},null,8,["message"])]),e("div",kt,[r(f,{for:"hourly_rate",value:"hourly_rate",class:"sr-only"}),e("div",Vt,[e("span",Ct,u(s.client.currency)+" / Hour",1),r(V,{id:"hourly_rate",modelValue:a(l).hourly_rate,"onUpdate:modelValue":t[12]||(t[12]=o=>a(l).hourly_rate=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Hourly Rate",onKeyup:b(v,["enter"])},null,8,["modelValue"])]),r(_,{message:a(l).errors.hourly_rate,class:"mt-2"},null,8,["message"])]),e("div",Mt,[r(f,{for:"hourly_rate_two",value:"hourly rate two",class:"sr-only"}),e("div",Tt,[e("span",Ht,u(s.client.currency)+" / Hour",1),r(V,{id:"hourly_rate_two",modelValue:a(l).hourly_rate_two,"onUpdate:modelValue":t[13]||(t[13]=o=>a(l).hourly_rate_two=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Second Hourly Rate",onKeyup:b(v,["enter"])},null,8,["modelValue"])]),r(_,{message:a(l).errors.hourly_rate_two,class:"mt-2"},null,8,["message"])]),e("div",Dt,[r(f,{for:"extra_time",value:"extra_time",class:"sr-only"}),e("div",zt,[r(V,{id:"extra_time",modelValue:a(l).extra_time,"onUpdate:modelValue":t[14]||(t[14]=o=>a(l).extra_time=o),type:"text",class:"mt-1 block w-32",placeholder:"Extra Minutes",onKeyup:b(v,["enter"])},null,8,["modelValue"]),e("span",St,[t[24]||(t[24]=c("Minutes / ")),e("b",null,u(W.value),1),t[25]||(t[25]=c(" Hours"))])]),r(_,{message:a(l).errors.extra_time,class:"mt-2"},null,8,["message"])]),e("div",Bt,[r(G,{onClick:B},{default:y(()=>t[26]||(t[26]=[c(" Close ")])),_:1}),r(nt,{class:x(["ms-3",{"opacity-25":a(l).processing}]),disabled:a(l).processing,onClick:v},{default:y(()=>t[27]||(t[27]=[c(" Save ")])),_:1},8,["class","disabled"])])])]),_:1},8,["show"]),r(q,{show:H.value,onClose:D},{default:y(()=>[e("div",Lt,[t[31]||(t[31]=e("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this proyect? ",-1)),t[32]||(t[32]=e("p",{class:"mt-1 text-sm text-gray-600"}," This proyect and all its time history will be deleted. ",-1)),e("div",Nt,[r(G,{onClick:D},{default:y(()=>t[29]||(t[29]=[c(" Close ")])),_:1}),r(at,{class:x(["ms-3",{"opacity-25":a(F).processing}]),disabled:a(F).processing,onClick:tt},{default:y(()=>t[30]||(t[30]=[c(" Delete Project ")])),_:1},8,["class","disabled"])])])]),_:1},8,["show"])],64))}};export{Kt as default};
