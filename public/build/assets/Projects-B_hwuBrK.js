import{k as c,h as I,z as ne,T as ie,f as p,a as l,u as r,w as h,F as S,o as g,Z as ue,b as t,j as de,d as y,t as a,e as q,i as f,v as ce,l as R,m as T,H as me,n as pe,G as x,q as z,E as ge,N as fe}from"./app-BloNxtzK.js";import{_ as ve}from"./AuthenticatedLayout-BUUBOBMp.js";import{_ as G,a as be}from"./DangerButton-CmKKXpRm.js";import{S as he}from"./SaveButton-jhdoi0T8.js";import{_ as w,a as V,b as D}from"./TextInput-PwV-8zbG.js";import ye from"./ProjectCard-HJwS_8TB.js";import{h as A}from"./helpers-B3tPaVM3.js";import"./ApplicationLogo-BKNd8GOD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const xe={class:"py-12"},we={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},_e={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},ke={class:"flex justify-between items-center mb-3 gap-2"},Ce={class:"flex gap-3 grow"},je=["disabled"],Se={class:"flex gap-2 items-center mb-2"},Te={class:"flex flex-wrap justify-between gap-5"},Ve=["onClick","onDragstart","onDrop"],De={class:"p-4 text-white bg-blue-500 min-w-[360px] min-h-[220px] w-fit rounded flex justify-center items-center shadow-2xl order-[999999]"},Ee={class:"p-6"},$e={class:"mt-6"},Ne={class:"mt-6"},Fe={class:"mt-6"},Me={class:"relative w-3/4"},He={class:"absolute right-2 top-[9px]"},Ue={class:"mt-6"},Be={class:"relative w-3/4"},Ke={class:"absolute right-2 top-[9px]"},Re={class:"mt-6 flex justify-end"},ze={class:"p-6"},Ae={class:"flex justify-between items-center gap-2 mb-5"},Le={class:"flex gap-1 justify-between items-center"},Oe=["disabled"],Pe=["disabled"],Ie={class:"w-full"},qe={class:"text-center px-5 py-1 text-lg font-bold bg-blue-200 border border-b-white"},Ge={class:"text-center px-5 py-1 text-lg font-bold bg-blue-200 border border-b-white"},We={class:"text-center px-5 py-1 text-lg font-bold bg-blue-200 border border-b-white"},Ze={class:"text-center px-5 py-1 text-lg font-bold bg-gray-200 border border-b-white"},Je={class:"text-center px-5 py-1 text-lg font-bold bg-gray-200 border border-b-white"},Qe={class:"text-xl"},nt={__name:"Projects",props:{projects:{type:Array},client:{type:Object},searchTerm:{type:String}},setup(v){const E=c(!1),$=c(null),W=c(null),_=c([]),N=c(!1),F=c(!1),C=c(!0),j=c(!1),b=v,i=I(()=>b.projects);ne(()=>{M()});const M=()=>{i.value.forEach((s,e)=>{i.value[e].show=!0})},H=c("");let L=0;const Z=s=>{clearTimeout(L),L=setTimeout(()=>{i.value.forEach((e,o)=>{e.name.toLowerCase().includes(H.value.toLowerCase())?i.value[o].show=!0:i.value[o].show=!1})},500)},J=()=>{setTimeout(()=>{i.value.forEach((s,e)=>{i.value[e].selected=N.value})},100)},Q=s=>{i.value[s].deleted=!0},X=()=>{z(()=>M())},Y=s=>{fe.get(route("project.show",s))},U=c(null),ee=s=>{U.value=s},te=s=>{s.preventDefault()},oe=s=>{const e=i.value[U.value].order,o=i.value[s].order;i.value[U.value].order=o,i.value[s].order=e;let u=[];i.value.forEach(d=>{u.push({id:d.id,order:d.order,name:d.name})}),axios.patch(route("project.ordering"),{projectsOrder:u}).then(d=>{d.data.success}).catch(function(d){})},n=ie({client_id:b.client.id,client_slug:b.client.slug,name:"",hourly_rate:String(b.client.hourly_rate),hourly_rate_two:String(b.client.hourly_rate_two),notes:""}),se=()=>{E.value=!0,z(()=>$.value.focus())},k=()=>{console.log(n),n.post(route("project.store"),{preserveScroll:!0,onSuccess:()=>{B(),z(()=>M())},onError:()=>$.value.focus()})},B=()=>{E.value=!1,n.reset()},O=c(0),P=c(0),K=c(0),m=(s,e=!1)=>{let o=e?s.hourly_rate_two:s.hourly_rate;return parseFloat(s.total_time/60/60*o).toFixed(2)},le=I(()=>!i.value.filter(s=>s.selected).length),re=()=>{_.value=i.value.filter(u=>u.selected);let s=0,e=0;const o=_.value.reduce((u,d)=>(s+=parseFloat(m(d)),e+=parseFloat(m(d,!0)),console.log(s),u+d.total_time),0);O.value=A.makeTimeClock(o),P.value=s.toFixed(2),K.value=e.toFixed(2),console.log(_.value),F.value=!0},ae=()=>{F.value=!1};return(s,e)=>(g(),p(S,null,[l(r(ue),{title:"Dashboard"}),l(ve,null,{header:h(()=>e[10]||(e[10]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Projects",-1)])),default:h(()=>[t("div",xe,[t("div",we,[t("div",_e,[t("div",ke,[t("div",Ce,[l(r(de),{href:s.route("client.index"),class:"grow-0 inline-flex items-center w-fit px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:h(()=>e[11]||(e[11]=[y(" << Back")])),_:1},8,["href"]),t("button",{type:"button",disabled:le.value,onClick:re,class:"grow-0 inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"}," Calculate",8,je),l(w,{for:"name",value:"name",class:"sr-only"}),l(V,{id:"name",ref_key:"searchInput",ref:W,onKeyup:Z,modelValue:H.value,"onUpdate:modelValue":e[0]||(e[0]=o=>H.value=o),type:"text",class:"grow",placeholder:"Search by Project Name"},null,8,["modelValue"])]),t("h1",null,a(v.client.name),1)]),t("div",Se,[l(w,{for:"selectall",value:"Select All",class:"text-black text-xl font-light leading-5",onClick:e[1]||(e[1]=q(()=>{},["stop"]))}),f(t("input",{type:"checkbox",id:"selectall","onUpdate:modelValue":e[2]||(e[2]=o=>N.value=o),onClick:e[3]||(e[3]=q(o=>J(),["stop"]))},null,512),[[ce,N.value]])]),t("div",Te,[(g(!0),p(S,null,R(i.value,(o,u)=>f((g(),p("div",{key:u,draggable:!0,onClick:d=>Y(o.id),onDragstart:d=>ee(u),onDragover:te,onDrop:d=>oe(u),style:ge("order:"+o.order),class:"p-3 hover:opacity-90 text-white bg-blue-500 min-w-[360px] min-h-[220px] w-[360px] rounded relative overflow-hidden shadow-xl border border-slate-400 cursor-pointer"},[l(ye,{project:o,client:v.client,"onDelete:project":Q,"onUpdate:project":X,index:u},null,8,["project","client","index"])],44,Ve)),[[x,o.show&&!o.deleted]])),128)),t("div",De,[(g(),p("svg",{class:"cursor-pointer w-20 h-20 opacity-50",onClick:se,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e[12]||(e[12]=[t("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"},null,-1)])))])]),l(G,{show:E.value,onClose:B},{default:h(()=>[t("div",Ee,[e[15]||(e[15]=t("h2",{class:"text-lg font-medium text-gray-900"}," Create new Project ",-1)),t("div",$e,[l(w,{for:"name",value:"name",class:"sr-only"}),l(V,{id:"name",ref_key:"projectNameInput",ref:$,modelValue:r(n).name,"onUpdate:modelValue":e[4]||(e[4]=o=>r(n).name=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Project Name",onKeyup:T(k,["enter"])},null,8,["modelValue"]),l(D,{message:r(n).errors.name,class:"mt-2"},null,8,["message"])]),t("div",Ne,[l(w,{for:"notes",value:"notes",class:"sr-only"}),f(t("textarea",{id:"notes","onUpdate:modelValue":e[5]||(e[5]=o=>r(n).notes=o),type:"text",class:"mt-1 block w-3/4 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"Notes",onKeyup:T(k,["enter"])},null,544),[[me,r(n).notes]]),l(D,{message:r(n).errors.notes,class:"mt-2"},null,8,["message"])]),t("div",Fe,[l(w,{for:"hourly_rate",value:"hourly_rate",class:"sr-only"}),t("div",Me,[t("span",He,a(b.client.currency)+" / Hour",1),l(V,{id:"hourly_rate",modelValue:r(n).hourly_rate,"onUpdate:modelValue":e[6]||(e[6]=o=>r(n).hourly_rate=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Hourly Rate",onKeyup:T(k,["enter"])},null,8,["modelValue"])]),l(D,{message:r(n).errors.hourly_rate,class:"mt-2"},null,8,["message"])]),t("div",Ue,[l(w,{for:"hourly_rate_two",value:"hourly rate two",class:"sr-only"}),t("div",Be,[t("span",Ke,a(b.client.currency)+" / Hour",1),l(V,{id:"hourly_rate_two",modelValue:r(n).hourly_rate_two,"onUpdate:modelValue":e[7]||(e[7]=o=>r(n).hourly_rate_two=o),type:"text",class:"mt-1 block w-3/4",placeholder:"Second Hourly Rate",onKeyup:T(k,["enter"])},null,8,["modelValue"])]),l(D,{message:r(n).errors.hourly_rate_two,class:"mt-2"},null,8,["message"])]),t("div",Re,[l(be,{onClick:B},{default:h(()=>e[13]||(e[13]=[y(" Close ")])),_:1}),l(he,{class:pe(["ms-3",{"opacity-25":r(n).processing}]),disabled:r(n).processing,onClick:k},{default:h(()=>e[14]||(e[14]=[y(" Save ")])),_:1},8,["class","disabled"])])])]),_:1},8,["show"]),l(G,{show:F.value,onClose:ae,maxWidth:"screenlg"},{default:h(()=>[t("div",ze,[t("div",Ae,[e[16]||(e[16]=t("h2",{class:"text-xl font-bold text-gray-900"}," Reports ",-1)),t("div",Le,[t("button",{type:"button",disabled:C.value,onClick:e[8]||(e[8]=o=>{C.value=!0,j.value=!1}),class:"grow-0 inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"}," Table",8,Oe),t("button",{type:"button",disabled:j.value,onClick:e[9]||(e[9]=o=>{C.value=!1,j.value=!0}),class:"grow-0 inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"}," Text",8,Pe)])]),f(t("table",Ie,[e[18]||(e[18]=t("tr",null,[t("th",null,"Name"),t("th",null,"Time"),t("th",null,"Earnings")],-1)),(g(!0),p(S,null,R(_.value,(o,u)=>(g(),p("tr",{key:u},[t("td",qe,a(o.name),1),t("td",Ge,a(r(A).makeTimeClock(o.total_time)),1),t("td",We,[y(a(m(o))+" "+a(v.client.currency)+" ",1),f(t("span",null," / "+a(m(o,!0))+" "+a(v.client.currency),513),[[x,m(o,!0)>0]])])]))),128)),t("tr",null,[e[17]||(e[17]=t("td",{class:"text-center px-5 py-1 text-lg font-bold bg-gray-200 border border-b-white"}," Totals ",-1)),t("td",Ze,a(O.value),1),t("td",Je,[y(a(P.value)+" ",1),f(t("span",null," / "+a(K.value)+" "+a(v.client.currency),513),[[x,K.value>0]])])])],512),[[x,C.value]]),f(t("div",null,[(g(!0),p(S,null,R(_.value,(o,u)=>(g(),p("div",{key:u,class:"mb-5"},[t("p",Qe,a(o.name),1),t("p",null,a(r(A).makeTimeClock(o.total_time)),1),t("p",null,[y(a(m(o))+" ",1),f(t("span",null," / "+a(m(o,!0))+" "+a(v.client.currency),513),[[x,m(o,!0)>0]])])]))),128))],512),[[x,j.value]])])]),_:1},8,["show"])])])])]),_:1})],64))}};export{nt as default};
